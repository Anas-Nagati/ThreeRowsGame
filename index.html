<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Three Rows Game</title>
    <script src="confetti.js"></script>
    <style>
        body {
            background-color: #f7e7ea;
        }

        .title {
            font-family: 'Comic Sans MS', cursive;
            font-size: xxx-large;
            color: #ff69b4;
            margin-bottom: 30px;
        }

        .game-board {
            margin: auto;
            text-align: center;
            position: absolute;
            width: 100%;
            background: transparent;
            top: 50px;
        }

        .row {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
        }

        #message {
            font-size: xx-large;
        }

        .dot {
            width: 90px;
            height: 90px;
            border-radius: 50%;
            margin: 0 10px;
            cursor: pointer;
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
            background: linear-gradient(to bottom right, #ff9a9e, #fad0c4, #fad0c4, #ffd1ff);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
        }

        .dot.selected {
            transform: scale(0.8);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .first-row .dot {
            background: linear-gradient(to bottom right, #ffdde1, #ffdde1);
        }

        .second-row .dot:nth-child(2n) {
            background: linear-gradient(to bottom right, #f6d365, #fda085);
        }

        .third-row .dot:nth-child(odd) {
            background: linear-gradient(to bottom right, #a1c4fd, #c2e9fb);
        }

        .new-game-button {
            background-color: #4CAF50;
            border: none;
            color: white;
            padding: 16px 32px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: xx-large;
            margin-top: 20px;
            cursor: pointer;
            border-radius: 8px;
            transition-duration: 0.4s;
        }

        .new-game-button:hover {
            background-color: #3e8e41;
        }

    </style>
</head>
<body>

<button id="gameModeMulti" onclick="selectMode('multiplayer')">Multiplayer</button>
<button id="gameModePc" onclick="selectMode('singleplayer')">Single Player</button>

<div class="game-board">
    <h1 class="title">Three Rows Game</h1>
    <div id="row-0" class="first-row row">
        <div class="dot" id="row-0-0"></div>
    </div>
    <div id="row-1" class="second-row row">
        <div class="dot" id="row-1-0"></div>
        <div class="dot" id="row-1-1"></div>
        <div class="dot" id="row-1-2"></div>
        <div class="dot" id="row-1-3"></div>

    </div>
    <div id="row-2" class="third-row row">
        <div class="dot" id="row-2-0"></div>
        <div class="dot" id="row-2-1"></div>
        <div class="dot" id="row-2-2"></div>
        <div class="dot" id="row-2-3"></div>
        <div class="dot" id="row-2-4"></div>
        <div class="dot" id="row-2-5"></div>
    </div>
    <p id="message">Player 1's turn</p>
    <button class="new-game-button" onclick="startNewGame()">New Game</button>
</div>
</div>
<script>

    function selectMode(mode) {
        var multiplayerScript = document.querySelector('script[src="multi.js"]');
        var singleplayerScript = document.querySelector('script[src="single.js"]');

        if (mode === 'multiplayer') {
            // include multi.js if not included
            if (!multiplayerScript) {
                // remove single.js if it is included
                if (singleplayerScript) {
                    singleplayerScript.remove();
                }
                // create a new script element and set its src attribute to multi.js
                var script = document.createElement('script');
                script.src = 'multi.js';
                // append the script element to the document's <head> element
                document.head.appendChild(script);
            }
        } else if (mode === 'singleplayer') {
            // include single.js if not included
            if (!singleplayerScript) {
                // remove multi.js if it is included
                if (multiplayerScript) {
                    multiplayerScript.remove();
                }
                // create a new script element and set its src attribute to single.js
                var script = document.createElement('script');
                script.src = 'single.js';
                // append the script element to the document's <head> element
                document.head.appendChild(script);
            }


            // let currentPlayer = Math.random() < 0.5 ? 'pc' : 'player';
            currentPlayer = 'pc';
            if (currentPlayer === 'pc') {
                // PC's turn
                // Select all divs with class row if they have a child element with class dot
                const dotDivs = document.querySelectorAll('.row');
                // convert the NodeList to an array
                const dotDivsArray = Array.from(dotDivs);
                // check if the selected divs have a child element with class dot and if not remove the div from the array of selected divs
                for (var i = 0; i < dotDivsArray.length; i++) {
                    if (dotDivsArray[i].querySelector('.dot') === null) {
                        // remove the div from the array of selected divs if it has no child elements with class dot
                        dotDivsArray.splice(i, 1);
                    }
                }

                // select one row at random from the array of selected divs
                var randomDotDiv = dotDivsArray[Math.floor(Math.random() * dotDivsArray.length)];

                // count the number of child elements with class "dot" in randomDotDiv
                var dotCount = randomDotDiv.querySelectorAll('.dot').length;

                // choose a random amount between 1 and the number of dots in the selected row (randomDotDiv) and make it less than to the number of dots in the selected row (randomDotDiv)
                var randomAmount = Math.floor(Math.random() * dotCount) + 1;
                console.log('Random amount:', randomAmount);

                // check if total number of dots in the document is equal to 1
                if (document.querySelectorAll('.dot').length <= 1) {
                    // if so, the game is over
                    // display a message that the PC has won
                    document.querySelector('#message').innerHTML = 'PC has won!';
                    startConfetti();
                    // disable player input
                    return;
                }


                // remove the selected amount of dots from the selected row
                for (var i = 0; i < randomAmount; i++) {
                    // remove randomAmount of child elements with class "dot" from randomDotDiv
                    randomDotDiv.removeChild(randomDotDiv.querySelector('.dot'));
                }

                // switch to player's turn
                currentPlayer = 'player';
                // display a message that it is the player's turn
                document.querySelector('#message').innerHTML = 'Player 1\'s turn';
                // enable player input

            }
        }

    }
</script>
</body>
</html>